

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>GLANCE: Global Actions in a Nutshell for Counterfactual Explainability &mdash; HumanCompatible.Explain  documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=e59714d7" />

  
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js?v=5929fcd5"></script>
      <script src="_static/doctools.js?v=9bcbadda"></script>
      <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="FCX: Finding Feasible Counterfactual Explanation" href="fcx.html" />
    <link rel="prev" title="FACTS: Fairness Aware Counterfactual for Subgrouos package" href="facts.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            HumanCompatible.Explain
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="facts.html">FACTS: Fairness Aware Counterfactual for Subgrouos package</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">GLANCE: Global Actions in a Nutshell for Counterfactual Explainability</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#global-counterfactual-methods">Global Counterfactual Methods</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#module-humancompatible.explain.glance.iterative_merges.iterative_merges">C-GLANCE (Iterative Merges)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#humancompatible.explain.glance.iterative_merges.iterative_merges.C_GLANCE"><code class="docutils literal notranslate"><span class="pre">C_GLANCE</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#humancompatible.explain.glance.iterative_merges.iterative_merges.action_fake_cost"><code class="docutils literal notranslate"><span class="pre">action_fake_cost()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#humancompatible.explain.glance.iterative_merges.iterative_merges.actions_cumulative_eff_cost"><code class="docutils literal notranslate"><span class="pre">actions_cumulative_eff_cost()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#humancompatible.explain.glance.iterative_merges.iterative_merges.cluster_results"><code class="docutils literal notranslate"><span class="pre">cluster_results()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#humancompatible.explain.glance.iterative_merges.iterative_merges.cumulative"><code class="docutils literal notranslate"><span class="pre">cumulative()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#humancompatible.explain.glance.iterative_merges.iterative_merges.format_glance_output"><code class="docutils literal notranslate"><span class="pre">format_glance_output()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#humancompatible.explain.glance.iterative_merges.iterative_merges.print_results"><code class="docutils literal notranslate"><span class="pre">print_results()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-humancompatible.explain.glance.counterfactual_tree.counterfactual_tree">T-GLANCE (Counterfactual Tree)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#humancompatible.explain.glance.counterfactual_tree.counterfactual_tree.T_GLANCE"><code class="docutils literal notranslate"><span class="pre">T_GLANCE</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#clustering-method-wrappers">Clustering Method Wrappers</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#humancompatible.explain.glance.clustering.kmeans.KMeansMethod"><code class="docutils literal notranslate"><span class="pre">KMeansMethod</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#humancompatible.explain.glance.clustering.kmeans.KMeansMethod.fit"><code class="docutils literal notranslate"><span class="pre">KMeansMethod.fit()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#humancompatible.explain.glance.clustering.kmeans.KMeansMethod.predict"><code class="docutils literal notranslate"><span class="pre">KMeansMethod.predict()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-humancompatible.explain.glance.local_cfs.dice_method">Local Counterfactual Methods</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#humancompatible.explain.glance.local_cfs.dice_method.DiceMethod"><code class="docutils literal notranslate"><span class="pre">DiceMethod</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#humancompatible.explain.glance.local_cfs.dice_method.DiceMethod.explain_instances"><code class="docutils literal notranslate"><span class="pre">DiceMethod.explain_instances()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#humancompatible.explain.glance.local_cfs.dice_method.DiceMethod.fit"><code class="docutils literal notranslate"><span class="pre">DiceMethod.fit()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#humancompatible.explain.glance.local_cfs.nearest_neighbor.NearestNeighborMethod"><code class="docutils literal notranslate"><span class="pre">NearestNeighborMethod</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#humancompatible.explain.glance.local_cfs.nearest_neighbor.NearestNeighborMethod.explain_instances"><code class="docutils literal notranslate"><span class="pre">NearestNeighborMethod.explain_instances()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#humancompatible.explain.glance.local_cfs.nearest_neighbor.NearestNeighborMethod.fit"><code class="docutils literal notranslate"><span class="pre">NearestNeighborMethod.fit()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#humancompatible.explain.glance.local_cfs.random_sampling.RandomSampling"><code class="docutils literal notranslate"><span class="pre">RandomSampling</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#humancompatible.explain.glance.local_cfs.random_sampling.RandomSampling.explain"><code class="docutils literal notranslate"><span class="pre">RandomSampling.explain()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#humancompatible.explain.glance.local_cfs.random_sampling.RandomSampling.explain_instances"><code class="docutils literal notranslate"><span class="pre">RandomSampling.explain_instances()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#humancompatible.explain.glance.local_cfs.random_sampling.RandomSampling.fit"><code class="docutils literal notranslate"><span class="pre">RandomSampling.fit()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-humancompatible.explain.glance.utils.action">Utility Functions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#humancompatible.explain.glance.utils.action.actions_mean_pandas"><code class="docutils literal notranslate"><span class="pre">actions_mean_pandas()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#humancompatible.explain.glance.utils.action.apply_action_numpy"><code class="docutils literal notranslate"><span class="pre">apply_action_numpy()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#humancompatible.explain.glance.utils.action.apply_action_pandas"><code class="docutils literal notranslate"><span class="pre">apply_action_pandas()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#humancompatible.explain.glance.utils.action.apply_actions_pandas_rows"><code class="docutils literal notranslate"><span class="pre">apply_actions_pandas_rows()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#humancompatible.explain.glance.utils.action.extract_actions_pandas"><code class="docutils literal notranslate"><span class="pre">extract_actions_pandas()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#humancompatible.explain.glance.utils.centroid.centroid_numpy"><code class="docutils literal notranslate"><span class="pre">centroid_numpy()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#humancompatible.explain.glance.utils.centroid.centroid_pandas"><code class="docutils literal notranslate"><span class="pre">centroid_pandas()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="fcx.html">FCX: Finding Feasible Counterfactual Explanation</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">HumanCompatible.Explain</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">GLANCE: Global Actions in a Nutshell for Counterfactual Explainability</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/glance.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="glance-global-actions-in-a-nutshell-for-counterfactual-explainability">
<h1>GLANCE: Global Actions in a Nutshell for Counterfactual Explainability<a class="headerlink" href="#glance-global-actions-in-a-nutshell-for-counterfactual-explainability" title="Link to this heading"></a></h1>
<nav class="contents local" id="contents">
<ul class="simple">
<li><p><a class="reference internal" href="#global-counterfactual-methods" id="id42">Global Counterfactual Methods</a></p></li>
<li><p><a class="reference internal" href="#clustering-method-wrappers" id="id43">Clustering Method Wrappers</a></p></li>
<li><p><a class="reference internal" href="#module-humancompatible.explain.glance.local_cfs.dice_method" id="id44">Local Counterfactual Methods</a></p></li>
<li><p><a class="reference internal" href="#module-humancompatible.explain.glance.utils.action" id="id45">Utility Functions</a></p></li>
</ul>
</nav>
<section id="global-counterfactual-methods">
<h2><a class="toc-backref" href="#id42" role="doc-backlink">Global Counterfactual Methods</a><a class="headerlink" href="#global-counterfactual-methods" title="Link to this heading"></a></h2>
<section id="module-humancompatible.explain.glance.iterative_merges.iterative_merges">
<span id="c-glance-iterative-merges"></span><h3>C-GLANCE (Iterative Merges)<a class="headerlink" href="#module-humancompatible.explain.glance.iterative_merges.iterative_merges" title="Link to this heading"></a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="humancompatible.explain.glance.iterative_merges.iterative_merges.C_GLANCE">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">humancompatible.explain.glance.iterative_merges.iterative_merges.</span></span><span class="sig-name descname"><span class="pre">C_GLANCE</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial_clusters</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">final_clusters</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_local_counterfactuals</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">heuristic_weights</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">(0.5,</span> <span class="pre">0.5)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alternative_merges</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_seed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">13</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/humancompatible/explain/glance/iterative_merges/iterative_merges.html#C_GLANCE"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#humancompatible.explain.glance.iterative_merges.iterative_merges.C_GLANCE" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">GlobalCounterfactualMethod</span></code></p>
<p>A class for generating global counterfactual explanations using an iterative merging approach.</p>
<p>It allows the user to control the number of clusters and the methods used
for clustering and generating counterfactuals.</p>
<section id="attributes">
<h4>Attributes:<a class="headerlink" href="#attributes" title="Link to this heading"></a></h4>
<dl class="simple">
<dt>model<span class="classifier">Any</span></dt><dd><p>The predictive model used for generating counterfactuals.</p>
</dd>
<dt>initial_clusters<span class="classifier">int</span></dt><dd><p>The initial number of clusters to form.</p>
</dd>
<dt>final_clusters<span class="classifier">int</span></dt><dd><p>The target number of clusters after merging.</p>
</dd>
<dt>num_local_counterfactuals<span class="classifier">int</span></dt><dd><p>The number of local counterfactuals to generate for each cluster.</p>
</dd>
<dt>heuristic_weights<span class="classifier">Tuple[float, float]</span></dt><dd><p>Weights used in the heuristic for merging clusters.</p>
</dd>
<dt>alternative_merges<span class="classifier">bool</span></dt><dd><p>If True, allows alternative merging strategies.</p>
</dd>
<dt>random_seed<span class="classifier">int</span></dt><dd><p>Seed for random number generation.</p>
</dd>
<dt>verbose<span class="classifier">bool</span></dt><dd><p>If True, enables verbose output during processing.</p>
</dd>
<dt>final_clustering<span class="classifier">Optional[Dict[int, pd.DataFrame]]</span></dt><dd><p>The final clustering of instances after merging.</p>
</dd>
<dt>cluster_results<span class="classifier">Optional[Dict[int, Dict[str, Any]]]</span></dt><dd><p>Results of the clustering including effectiveness and cost metrics.</p>
</dd>
</dl>
</section>
<section id="methods">
<h4>Methods:<a class="headerlink" href="#methods" title="Link to this heading"></a></h4>
<dl class="simple">
<dt>_set_features_names(X, numerical_names, categorical_names):</dt><dd><p>Sets the feature names for numerical and categorical features.</p>
</dd>
<dt>fit(X, y, train_dataset, feat_to_vary, numeric_features_names, categorical_features_names,</dt><dd><p>clustering_method, cf_generator, cluster_action_choice_algo, …)
Fits the clustering and counterfactual generation model to the provided dataset.</p>
</dd>
<dt>explain_group(instances):</dt><dd><p>Explains the group of instances by generating counterfactuals based on clustering.</p>
</dd>
<dt>global_actions():</dt><dd><p>Retrieves the global actions derived from the clustered results.</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="humancompatible.explain.glance.iterative_merges.iterative_merges.C_GLANCE.explain_group">
<span class="sig-name descname"><span class="pre">explain_group</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">instances</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/humancompatible/explain/glance/iterative_merges/iterative_merges.html#C_GLANCE.explain_group"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#humancompatible.explain.glance.iterative_merges.iterative_merges.C_GLANCE.explain_group" title="Link to this definition"></a></dt>
<dd><p>Explains the group of instances by generating counterfactuals based on clustering.</p>
<section id="parameters">
<h5>Parameters:<a class="headerlink" href="#parameters" title="Link to this heading"></a></h5>
<dl class="simple">
<dt>instances<span class="classifier">pd.DataFrame</span></dt><dd><p>The group of instances to explain.</p>
</dd>
</dl>
</section>
<section id="returns">
<h5>Returns:<a class="headerlink" href="#returns" title="Link to this heading"></a></h5>
<dl class="simple">
<dt>Tuple[int, float]</dt><dd><p>A tuple containing the total effectiveness and total cost of the generated counterfactuals.</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="humancompatible.explain.glance.iterative_merges.iterative_merges.C_GLANCE.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Series</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_dataset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">feat_to_vary</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'all'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">numeric_features_names</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">categorical_features_names</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clustering_method</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ClusteringMethod</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'KMeans'</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'KMeans'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cf_generator</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">LocalCounterfactualMethod</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'Dice'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'NearestNeighbors'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'RandomSampling'</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'Dice'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cluster_action_choice_algo</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'max-eff'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'mean-act'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'low-cost'</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'max-eff'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nns__n_scalars</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rs__n_most_important</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rs__n_categorical_most_frequent</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lowcost__action_threshold</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lowcost__num_low_cost</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_cost_eff_thres__effectiveness_threshold</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_cost_eff_thres_combinations__num_min_cost</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eff_thres_hybrid__max_n_actions_full_combinations</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="glance.iterative_merges.html#humancompatible.explain.glance.iterative_merges.iterative_merges.C_GLANCE" title="humancompatible.explain.glance.iterative_merges.iterative_merges.C_GLANCE"><span class="pre">C_GLANCE</span></a></span></span><a class="reference internal" href="_modules/humancompatible/explain/glance/iterative_merges/iterative_merges.html#C_GLANCE.fit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#humancompatible.explain.glance.iterative_merges.iterative_merges.C_GLANCE.fit" title="Link to this definition"></a></dt>
<dd><p>Fits the clustering and counterfactual generation model to the provided dataset.</p>
<section id="id1">
<h5>Parameters:<a class="headerlink" href="#id1" title="Link to this heading"></a></h5>
<dl class="simple">
<dt>X<span class="classifier">pd.DataFrame</span></dt><dd><p>Features of the dataset.</p>
</dd>
<dt>y<span class="classifier">pd.Series</span></dt><dd><p>Target variable.</p>
</dd>
<dt>train_dataset<span class="classifier">pd.DataFrame</span></dt><dd><p>The training dataset used for local counterfactual generation methods.</p>
</dd>
<dt>feat_to_vary<span class="classifier">Optional[Union[List[str], str]], optional</span></dt><dd><p>Features to vary in counterfactual generation. Default is “all”.</p>
</dd>
<dt>numeric_features_names<span class="classifier">Optional[List[str]], optional</span></dt><dd><p>List of numeric feature names. If None, they will be inferred from X.</p>
</dd>
<dt>categorical_features_names<span class="classifier">Optional[List[str]], optional</span></dt><dd><p>List of categorical feature names. If None, they will be inferred from X.</p>
</dd>
<dt>clustering_method<span class="classifier">Union[ClusteringMethod, Literal[“KMeans”]], optional</span></dt><dd><p>The clustering method to use. Default is “KMeans”.</p>
</dd>
<dt>cf_generator<span class="classifier">Union[LocalCounterfactualMethod, Literal[“Dice”, “NearestNeighbors”, “RandomSampling”]], optional</span></dt><dd><p>The local counterfactual generation method to use. Default is “Dice”.</p>
</dd>
<dt>cluster_action_choice_algo<span class="classifier">Literal[“max-eff”, “mean-act”, “low-cost””], optional</span></dt><dd><p>The algorithm for selecting actions from clusters. Default is “max-eff”.</p>
</dd>
<dt>nns__n_scalars<span class="classifier">Optional[int], optional</span></dt><dd><p>Number of scalar features to use for nearest neighbors. Default is None.</p>
</dd>
<dt>rs__n_most_important<span class="classifier">Optional[int], optional</span></dt><dd><p>Number of most important features for random sampling. Default is None.</p>
</dd>
<dt>rs__n_categorical_most_frequent<span class="classifier">Optional[int], optional</span></dt><dd><p>Number of most frequent categorical features for random sampling. Default is None.</p>
</dd>
<dt>lowcost__action_threshold<span class="classifier">Optional[int], optional</span></dt><dd><p>Action threshold for low-cost methods. Default is None.</p>
</dd>
<dt>lowcost__num_low_cost<span class="classifier">Optional[int], optional</span></dt><dd><p>Number of low-cost actions to consider. Default is None.</p>
</dd>
<dt>min_cost_eff_thres__effectiveness_threshold<span class="classifier">Optional[float], optional</span></dt><dd><p>Effectiveness threshold for minimum cost methods. Default is None.</p>
</dd>
<dt>min_cost_eff_thres_combinations__num_min_cost<span class="classifier">Optional[int], optional</span></dt><dd><p>Number of minimum cost combinations to evaluate. Default is None.</p>
</dd>
<dt>eff_thres_hybrid__max_n_actions_full_combinations<span class="classifier">Optional[int], optional</span></dt><dd><p>Maximum number of actions for full combinations in hybrid thresholding. Default is None.</p>
</dd>
</dl>
</section>
<section id="id2">
<h5>Returns:<a class="headerlink" href="#id2" title="Link to this heading"></a></h5>
<dl class="simple">
<dt>IterativeMerges</dt><dd><p>Returns the fitted instance of IterativeMerges.</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="humancompatible.explain.glance.iterative_merges.iterative_merges.C_GLANCE.global_actions">
<span class="sig-name descname"><span class="pre">global_actions</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/humancompatible/explain/glance/iterative_merges/iterative_merges.html#C_GLANCE.global_actions"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#humancompatible.explain.glance.iterative_merges.iterative_merges.C_GLANCE.global_actions" title="Link to this definition"></a></dt>
<dd></dd></dl>

</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="humancompatible.explain.glance.iterative_merges.iterative_merges.action_fake_cost">
<span class="sig-prename descclassname"><span class="pre">humancompatible.explain.glance.iterative_merges.iterative_merges.</span></span><span class="sig-name descname"><span class="pre">action_fake_cost</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">action</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Series</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">numerical_features_names</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">categorical_features_names</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/humancompatible/explain/glance/iterative_merges/iterative_merges.html#action_fake_cost"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#humancompatible.explain.glance.iterative_merges.iterative_merges.action_fake_cost" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="humancompatible.explain.glance.iterative_merges.iterative_merges.actions_cumulative_eff_cost">
<span class="sig-prename descclassname"><span class="pre">humancompatible.explain.glance.iterative_merges.iterative_merges.</span></span><span class="sig-name descname"><span class="pre">actions_cumulative_eff_cost</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">actions_with_costs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Series</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dist_func_dataframe</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">DataFrame</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">DataFrame</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Series</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">numerical_columns</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">categorical_columns</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">categorical_no_action_token</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/humancompatible/explain/glance/iterative_merges/iterative_merges.html#actions_cumulative_eff_cost"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#humancompatible.explain.glance.iterative_merges.iterative_merges.actions_cumulative_eff_cost" title="Link to this definition"></a></dt>
<dd><p>Evaluates the cumulative effectiveness and cost of applying a sequence of actions
to a dataset using a predictive model.</p>
<p>This function applies each action from the sorted list of actions with their costs,
predicts the outcomes, and calculates the total number of predictions that were flipped
as well as the total recourse cost incurred from the actions.</p>
<section id="id3">
<h4>Parameters:<a class="headerlink" href="#id3" title="Link to this heading"></a></h4>
<dl class="simple">
<dt>model<span class="classifier">Any</span></dt><dd><p>A machine learning model used for making predictions on the modified instances.</p>
</dd>
<dt>X<span class="classifier">pd.DataFrame</span></dt><dd><p>The original DataFrame of instances to which actions will be applied.</p>
</dd>
<dt>actions_with_costs<span class="classifier">List[Tuple[pd.Series, float]]</span></dt><dd><p>A list of tuples where each tuple contains:
- A pandas Series representing the action to apply.
- A float representing the cost associated with the action.</p>
</dd>
<dt>dist_func_dataframe<span class="classifier">Callable[[pd.DataFrame, pd.DataFrame], pd.Series]</span></dt><dd><p>A function that computes the distance or cost between two DataFrames.</p>
</dd>
<dt>numerical_columns<span class="classifier">List[str]</span></dt><dd><p>A list of names for the numerical columns in the DataFrame.</p>
</dd>
<dt>categorical_columns<span class="classifier">List[str]</span></dt><dd><p>A list of names for the categorical columns in the DataFrame.</p>
</dd>
<dt>categorical_no_action_token<span class="classifier">Any</span></dt><dd><p>A token used to represent the absence of an action for categorical features.</p>
</dd>
</dl>
</section>
<section id="id4">
<h4>Returns:<a class="headerlink" href="#id4" title="Link to this heading"></a></h4>
<dl class="simple">
<dt>Tuple[float, float]</dt><dd><p>A tuple containing:
- The total number of predictions flipped across all actions applied.
- The total recourse cost incurred from applying the actions.</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="humancompatible.explain.glance.iterative_merges.iterative_merges.cluster_results">
<span class="sig-prename descclassname"><span class="pre">humancompatible.explain.glance.iterative_merges.iterative_merges.</span></span><span class="sig-name descname"><span class="pre">cluster_results</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">instances</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clusters</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">DataFrame</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cluster_expl_actions</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">DataFrame</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dist_func_dataframe</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">DataFrame</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">DataFrame</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Series</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">numerical_features_names</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">categorical_features_names</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cluster_action_choice_algo</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'max-eff'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'mean-act'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'low-cost'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'min-cost-eff-thres'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'eff-thres-hybrid'</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'max-eff'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">action_threshold</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_low_cost</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">20</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">effectiveness_threshold</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_min_cost</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_n_actions_full_combinations</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">50</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/humancompatible/explain/glance/iterative_merges/iterative_merges.html#cluster_results"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#humancompatible.explain.glance.iterative_merges.iterative_merges.cluster_results" title="Link to this definition"></a></dt>
<dd><p>Evaluates and selects actions for each cluster based on a specified action choice algorithm.</p>
<p>This function iterates through each cluster of instances, applying the specified algorithm to
select the best action for achieving recourse while minimizing costs. It calculates the total
effectiveness and mean recourse costs across all clusters.</p>
<section id="id5">
<h4>Parameters:<a class="headerlink" href="#id5" title="Link to this heading"></a></h4>
<dl class="simple">
<dt>model<span class="classifier">Any</span></dt><dd><p>A machine learning model used for making predictions on modified instances.</p>
</dd>
<dt>instances<span class="classifier">pd.DataFrame</span></dt><dd><p>The DataFrame of original instances to which actions will be applied.</p>
</dd>
<dt>clusters<span class="classifier">Dict[int, pd.DataFrame]</span></dt><dd><p>A dictionary mapping cluster IDs to DataFrames of instances belonging to each cluster.</p>
</dd>
<dt>cluster_expl_actions<span class="classifier">Dict[int, pd.DataFrame]</span></dt><dd><p>A dictionary mapping cluster IDs to DataFrames of candidate actions for each cluster.</p>
</dd>
<dt>dist_func_dataframe<span class="classifier">Callable[[pd.DataFrame, pd.DataFrame], pd.Series]</span></dt><dd><p>A function that computes the distance or cost between two DataFrames.</p>
</dd>
<dt>numerical_features_names<span class="classifier">List[str]</span></dt><dd><p>A list of names for the numerical columns in the DataFrames.</p>
</dd>
<dt>categorical_features_names<span class="classifier">List[str]</span></dt><dd><p>A list of names for the categorical columns in the DataFrames.</p>
</dd>
<dt>cluster_action_choice_algo<span class="classifier">Literal[“max-eff”, “mean-act”, “low-cost”, “min-cost-eff-thres”, “eff-thres-hybrid”]</span></dt><dd><p>The algorithm to use for selecting actions from candidate actions. Options include:
- “max-eff”: Select the action with maximum effectiveness.
- “mean-act”: Select the mean action from candidate actions.
- “low-cost”: Select actions based on low cost.</p>
</dd>
<dt>action_threshold<span class="classifier">int</span></dt><dd><p>Minimum threshold for the number of flipped predictions required to consider an action effective.</p>
</dd>
<dt>num_low_cost<span class="classifier">int</span></dt><dd><p>The number of low-cost actions to consider (used when the low-cost algorithm is selected).</p>
</dd>
<dt>effectiveness_threshold<span class="classifier">float</span></dt><dd><p>Minimum effectiveness required for actions (used when the min-cost-eff-thres algorithm is selected).</p>
</dd>
<dt>num_min_cost<span class="classifier">Optional[int]</span></dt><dd><p>Number of minimum cost actions to consider (used when the min-cost-eff-thres algorithm is selected).</p>
</dd>
<dt>max_n_actions_full_combinations<span class="classifier">int</span></dt><dd><p>Maximum number of actions to evaluate in full combinations (not currently used in the function).</p>
</dd>
</dl>
</section>
<section id="id6">
<h4>Returns:<a class="headerlink" href="#id6" title="Link to this heading"></a></h4>
<dl class="simple">
<dt>Tuple[Dict[int, Dict[str, Any]], float, float]</dt><dd><p>A tuple containing:
- A dictionary where each key is a cluster ID and each value is another dictionary with the selected action, its effectiveness, and cost.
- Total effectiveness percentage across all clusters.
- Total mean recourse cost across all clusters.</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="humancompatible.explain.glance.iterative_merges.iterative_merges.cumulative">
<span class="sig-prename descclassname"><span class="pre">humancompatible.explain.glance.iterative_merges.iterative_merges.</span></span><span class="sig-name descname"><span class="pre">cumulative</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">instances</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">actions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dist_func_dataframe</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">numeric_features_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">categorical_features_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">categorical_no_action_token</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/humancompatible/explain/glance/iterative_merges/iterative_merges.html#cumulative"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#humancompatible.explain.glance.iterative_merges.iterative_merges.cumulative" title="Link to this definition"></a></dt>
<dd><p>Computes the cumulative effectiveness and cost of applying a set of actions
to a given set of instances using a predictive model.</p>
<section id="id7">
<h4>Parameters:<a class="headerlink" href="#id7" title="Link to this heading"></a></h4>
<dl class="simple">
<dt>model<span class="classifier">Any</span></dt><dd><p>A predictive model with a predict method. This model will be used to predict
outcomes after applying actions to the input instances.</p>
</dd>
<dt>instances<span class="classifier">pd.DataFrame</span></dt><dd><p>A DataFrame containing the instances for which actions are to be applied.</p>
</dd>
<dt>actions<span class="classifier">List[dict]</span></dt><dd><p>A list of actions, where each action is represented as a dictionary that
specifies how to modify the instances.</p>
</dd>
<dt>dist_func_dataframe<span class="classifier">Callable[[pd.DataFrame, pd.DataFrame], pd.Series]</span></dt><dd><p>A distance function that takes two DataFrames and returns a Series of distances
between corresponding rows.</p>
</dd>
<dt>numeric_features_names<span class="classifier">List[str]</span></dt><dd><p>A list of names for the numeric features in the instances DataFrame.</p>
</dd>
<dt>categorical_features_names<span class="classifier">List[str]</span></dt><dd><p>A list of names for the categorical features in the instances DataFrame.</p>
</dd>
<dt>categorical_no_action_token<span class="classifier">Any</span></dt><dd><p>A token used to represent a no-action state for categorical features.</p>
</dd>
</dl>
</section>
<section id="id8">
<h4>Returns:<a class="headerlink" href="#id8" title="Link to this heading"></a></h4>
<dl>
<dt>Tuple[int, float]</dt><dd><p>A tuple containing:
- effectiveness: An integer count of how many actions were effective (i.e.,</p>
<blockquote>
<div><p>resulted in a finite cost).</p>
</div></blockquote>
<ul class="simple">
<li><p>cost: A float representing the total cost incurred by the effective actions.</p></li>
</ul>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="humancompatible.explain.glance.iterative_merges.iterative_merges.format_glance_output">
<span class="sig-prename descclassname"><span class="pre">humancompatible.explain.glance.iterative_merges.iterative_merges.</span></span><span class="sig-name descname"><span class="pre">format_glance_output</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cluster_stats</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Number</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">categorical_columns</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/humancompatible/explain/glance/iterative_merges/iterative_merges.html#format_glance_output"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#humancompatible.explain.glance.iterative_merges.iterative_merges.format_glance_output" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="humancompatible.explain.glance.iterative_merges.iterative_merges.print_results">
<span class="sig-prename descclassname"><span class="pre">humancompatible.explain.glance.iterative_merges.iterative_merges.</span></span><span class="sig-name descname"><span class="pre">print_results</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">clusters_stats</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Number</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">total_effectiveness</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">total_cost</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/humancompatible/explain/glance/iterative_merges/iterative_merges.html#print_results"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#humancompatible.explain.glance.iterative_merges.iterative_merges.print_results" title="Link to this definition"></a></dt>
<dd><p>Prints the statistics for each cluster, including effectiveness and cost.</p>
<p>This function takes the results of cluster analysis and formats them for easy
viewing. It displays the size of each cluster, the actions taken, and the
effectiveness and cost of those actions.</p>
<section id="id9">
<h4>Parameters:<a class="headerlink" href="#id9" title="Link to this heading"></a></h4>
<dl>
<dt>clusters_stats<span class="classifier">Dict[int, Dict[str, numbers.Number]]</span></dt><dd><p>A dictionary where keys are cluster IDs (integers) and values are
dictionaries containing statistics for each cluster. Each value dictionary
must contain the following keys:</p>
<blockquote>
<div><ul class="simple">
<li><p>“size”: The size of the cluster.</p></li>
<li><p>“action”: The actions taken for the cluster.</p></li>
<li><p>“effectiveness”: The effectiveness of the actions in the cluster.</p></li>
<li><p>“cost”: The cost associated with the actions.</p></li>
</ul>
</div></blockquote>
</dd>
<dt>total_effectiveness<span class="classifier">float</span></dt><dd><p>The total effectiveness percentage across all clusters, represented as a decimal
(e.g., 0.75 for 75%).</p>
</dd>
<dt>total_cost<span class="classifier">float</span></dt><dd><p>The total cost associated with the actions taken across all clusters.</p>
</dd>
</dl>
</section>
</dd></dl>

</section>
<section id="module-humancompatible.explain.glance.counterfactual_tree.counterfactual_tree">
<span id="t-glance-counterfactual-tree"></span><h3>T-GLANCE (Counterfactual Tree)<a class="headerlink" href="#module-humancompatible.explain.glance.counterfactual_tree.counterfactual_tree" title="Link to this heading"></a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="humancompatible.explain.glance.counterfactual_tree.counterfactual_tree.T_GLANCE">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">humancompatible.explain.glance.counterfactual_tree.counterfactual_tree.</span></span><span class="sig-name descname"><span class="pre">T_GLANCE</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">split_features</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">partition_counterfactuals</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">child_count</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">global_method</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">GlobalCounterfactualMethod</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">local_method</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">LocalCounterfactualMethod</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_local_counterfactuals</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">100</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/humancompatible/explain/glance/counterfactual_tree/counterfactual_tree.html#T_GLANCE"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#humancompatible.explain.glance.counterfactual_tree.counterfactual_tree.T_GLANCE" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>A class to generate counterfactual explanations using a decision tree-like structure.</p>
<p>This class allows users to create a tree structure for counterfactual generation,
optimizing effectiveness and cost based on specified features. It supports both local
and global methods for generating counterfactuals.</p>
<section id="id10">
<h4>Attributes:<a class="headerlink" href="#id10" title="Link to this heading"></a></h4>
<dl class="simple">
<dt>model<span class="classifier">Any</span></dt><dd><p>The predictive model used for generating counterfactuals.</p>
</dd>
<dt>split_features<span class="classifier">Union[List, int]</span></dt><dd><p>Features to split the tree. Can be a list of feature names or an integer specifying
the number of top features to use based on permutation importance.</p>
</dd>
<dt>partition_counterfactuals<span class="classifier">int</span></dt><dd><p>The number of partitions to create for counterfactuals.</p>
</dd>
<dt>child_count<span class="classifier">int</span></dt><dd><p>The number of children each node can have.</p>
</dd>
<dt>global_method<span class="classifier">Union[GlobalCounterfactualMethod, str]</span></dt><dd><p>The global counterfactual generation method to use.</p>
</dd>
<dt>local_method<span class="classifier">Union[LocalCounterfactualMethod, str]</span></dt><dd><p>The local counterfactual generation method to use.</p>
</dd>
<dt>num_local_counterfactuals<span class="classifier">int</span></dt><dd><p>The number of local counterfactuals to generate.</p>
</dd>
<dt>node<span class="classifier">Node</span></dt><dd><p>The root node of the counterfactual tree.</p>
</dd>
<dt>node_instances<span class="classifier">pd.DataFrame</span></dt><dd><p>The instances that were used to build the counterfactual tree.</p>
</dd>
<dt>dist_func_dataframe<span class="classifier">Callable</span></dt><dd><p>A distance function for calculating distances between instances.</p>
</dd>
</dl>
</section>
<section id="id11">
<h4>Methods:<a class="headerlink" href="#id11" title="Link to this heading"></a></h4>
<dl class="simple">
<dt>fit(X, y, train_dataset=None, feat_to_vary=”all”, random_seed=13, numeric_features_names=None, categorical_features_names=None):</dt><dd><p>Fits the counterfactual tree to the provided data.</p>
</dd>
<dt>_local_group_eff_cost(instances):</dt><dd><p>Calculates the effectiveness and cost of local counterfactuals for a group of instances.</p>
</dd>
<dt>_group_eff_cost(instances):</dt><dd><p>Calculates the effectiveness and cost of counterfactuals for a group of instances,
utilizing local or global methods.</p>
</dd>
<dt>partition_group(instances):</dt><dd><p>Partitions the group of instances into a tree structure based on the specified features.</p>
</dd>
<dt>cumulative_leaf_actions():</dt><dd><p>Computes the total effectiveness and cost of actions taken from leaf nodes of the tree.</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="humancompatible.explain.glance.counterfactual_tree.counterfactual_tree.T_GLANCE.cumulative_leaf_actions">
<span class="sig-name descname"><span class="pre">cumulative_leaf_actions</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/humancompatible/explain/glance/counterfactual_tree/counterfactual_tree.html#T_GLANCE.cumulative_leaf_actions"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#humancompatible.explain.glance.counterfactual_tree.counterfactual_tree.T_GLANCE.cumulative_leaf_actions" title="Link to this definition"></a></dt>
<dd><p>Computes the total effectiveness and cost of actions taken from leaf nodes of the tree.</p>
<section id="id12">
<h5>Returns:<a class="headerlink" href="#id12" title="Link to this heading"></a></h5>
<dl class="simple">
<dt>Tuple[float, float, int]</dt><dd><p>A tuple containing the total effectiveness, total cost, and the number of actions taken.</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="humancompatible.explain.glance.counterfactual_tree.counterfactual_tree.T_GLANCE.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Series</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_dataset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">feat_to_vary</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'all'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_seed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">13</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">numeric_features_names</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">categorical_features_names</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/humancompatible/explain/glance/counterfactual_tree/counterfactual_tree.html#T_GLANCE.fit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#humancompatible.explain.glance.counterfactual_tree.counterfactual_tree.T_GLANCE.fit" title="Link to this definition"></a></dt>
<dd><p>Fits the counterfactual tree to the provided data.</p>
<section id="id13">
<h5>Parameters:<a class="headerlink" href="#id13" title="Link to this heading"></a></h5>
<dl class="simple">
<dt>X<span class="classifier">pd.DataFrame</span></dt><dd><p>Features of the dataset.</p>
</dd>
<dt>y<span class="classifier">pd.Series</span></dt><dd><p>Target variable.</p>
</dd>
<dt>train_dataset<span class="classifier">Optional[pd.DataFrame], optional</span></dt><dd><p>The training dataset to use for local counterfactual generation methods.</p>
</dd>
<dt>feat_to_vary<span class="classifier">Optional[Union[List[str], str]], optional</span></dt><dd><p>Features to vary in counterfactual generation. Default is “all”.</p>
</dd>
<dt>random_seed<span class="classifier">int, optional</span></dt><dd><p>Random seed for reproducibility. Default is 13.</p>
</dd>
<dt>numeric_features_names<span class="classifier">Optional[List[str]], optional</span></dt><dd><p>List of numeric feature names. If None, they will be inferred from X.</p>
</dd>
<dt>categorical_features_names<span class="classifier">Optional[List[str]], optional</span></dt><dd><p>List of categorical feature names. If None, they will be inferred from X.</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="humancompatible.explain.glance.counterfactual_tree.counterfactual_tree.T_GLANCE.partition_group">
<span class="sig-name descname"><span class="pre">partition_group</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">instances</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/humancompatible/explain/glance/counterfactual_tree/counterfactual_tree.html#T_GLANCE.partition_group"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#humancompatible.explain.glance.counterfactual_tree.counterfactual_tree.T_GLANCE.partition_group" title="Link to this definition"></a></dt>
<dd><p>Partitions the group of instances into a tree structure based on the specified features.</p>
<section id="id14">
<h5>Parameters:<a class="headerlink" href="#id14" title="Link to this heading"></a></h5>
<dl class="simple">
<dt>instances<span class="classifier">pd.DataFrame</span></dt><dd><p>The group of instances to partition.</p>
</dd>
</dl>
</section>
<section id="id15">
<h5>Returns:<a class="headerlink" href="#id15" title="Link to this heading"></a></h5>
<dl class="simple">
<dt>Node</dt><dd><p>The root node of the partitioned tree.</p>
</dd>
</dl>
</section>
</dd></dl>

</section>
</dd></dl>

</section>
</section>
<section id="clustering-method-wrappers">
<h2><a class="toc-backref" href="#id43" role="doc-backlink">Clustering Method Wrappers</a><a class="headerlink" href="#clustering-method-wrappers" title="Link to this heading"></a></h2>
<dl class="py class" id="module-humancompatible.explain.glance.clustering.kmeans">
<dt class="sig sig-object py" id="humancompatible.explain.glance.clustering.kmeans.KMeansMethod">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">humancompatible.explain.glance.clustering.kmeans.</span></span><span class="sig-name descname"><span class="pre">KMeansMethod</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_clusters</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_seed</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/humancompatible/explain/glance/clustering/kmeans.html#KMeansMethod"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#humancompatible.explain.glance.clustering.kmeans.KMeansMethod" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">ClusteringMethod</span></code></p>
<p>Implementation of a clustering method using KMeans.</p>
<p>This class provides an interface to apply KMeans clustering to a dataset.</p>
<dl class="py method">
<dt class="sig sig-object py" id="humancompatible.explain.glance.clustering.kmeans.KMeansMethod.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/humancompatible/explain/glance/clustering/kmeans.html#KMeansMethod.fit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#humancompatible.explain.glance.clustering.kmeans.KMeansMethod.fit" title="Link to this definition"></a></dt>
<dd><p>Fits the KMeans model on the provided dataset.</p>
<section id="id16">
<h3>Parameters:<a class="headerlink" href="#id16" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>data<span class="classifier">array-like or sparse matrix, shape (n_samples, n_features)</span></dt><dd><p>Training instances to cluster.</p>
</dd>
</dl>
</section>
<section id="id17">
<h3>Returns:<a class="headerlink" href="#id17" title="Link to this heading"></a></h3>
<p>None</p>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="humancompatible.explain.glance.clustering.kmeans.KMeansMethod.predict">
<span class="sig-name descname"><span class="pre">predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">instances</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/humancompatible/explain/glance/clustering/kmeans.html#KMeansMethod.predict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#humancompatible.explain.glance.clustering.kmeans.KMeansMethod.predict" title="Link to this definition"></a></dt>
<dd><p>Predicts the nearest cluster each sample in the provided data belongs to.</p>
<section id="id18">
<h3>Parameters:<a class="headerlink" href="#id18" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>instances<span class="classifier">array-like or sparse matrix, shape (n_samples, n_features)</span></dt><dd><p>New data to predict.</p>
</dd>
</dl>
</section>
<section id="id19">
<h3>Returns:<a class="headerlink" href="#id19" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>labels<span class="classifier">array, shape (n_samples,)</span></dt><dd><p>Index of the cluster each sample belongs to.</p>
</dd>
</dl>
</section>
</dd></dl>

</dd></dl>

</section>
<section id="module-humancompatible.explain.glance.local_cfs.dice_method">
<span id="local-counterfactual-methods"></span><h2><a class="toc-backref" href="#id44" role="doc-backlink">Local Counterfactual Methods</a><a class="headerlink" href="#module-humancompatible.explain.glance.local_cfs.dice_method" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="humancompatible.explain.glance.local_cfs.dice_method.DiceMethod">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">humancompatible.explain.glance.local_cfs.dice_method.</span></span><span class="sig-name descname"><span class="pre">DiceMethod</span></span><a class="reference internal" href="_modules/humancompatible/explain/glance/local_cfs/dice_method.html#DiceMethod"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#humancompatible.explain.glance.local_cfs.dice_method.DiceMethod" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">LocalCounterfactualMethod</span></code></p>
<p>Implementation of the Dice method for generating counterfactual instances.(<a class="reference external" href="https://interpret.ml/DiCE/">https://interpret.ml/DiCE/</a>)</p>
<p>The Dice method uses a specified machine learning model and data to generate counterfactual examples,
providing insights into how changes in feature values can influence model predictions.</p>
<section id="id20">
<h3>Methods:<a class="headerlink" href="#id20" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>__init__():</dt><dd><p>Initializes the DiceMethod instance.</p>
</dd>
<dt>fit(model, data, outcome_name, continuous_features, feat_to_vary, random_seed=13):</dt><dd><p>Fits the DiceMethod to the provided dataset, preparing the counterfactual generator.</p>
</dd>
<dt>explain_instances(instances, num_counterfactuals):</dt><dd><p>Generates counterfactual instances for the specified input instances.</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="humancompatible.explain.glance.local_cfs.dice_method.DiceMethod.explain_instances">
<span class="sig-name descname"><span class="pre">explain_instances</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">instances</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_counterfactuals</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">DataFrame</span></span></span><a class="reference internal" href="_modules/humancompatible/explain/glance/local_cfs/dice_method.html#DiceMethod.explain_instances"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#humancompatible.explain.glance.local_cfs.dice_method.DiceMethod.explain_instances" title="Link to this definition"></a></dt>
<dd><p>Generates counterfactual instances for the specified input instances.</p>
<section id="id21">
<h4>Parameters:<a class="headerlink" href="#id21" title="Link to this heading"></a></h4>
<dl class="simple">
<dt>instances<span class="classifier">pd.DataFrame</span></dt><dd><p>DataFrame containing the instances for which counterfactuals are generated.</p>
</dd>
<dt>num_counterfactuals<span class="classifier">int</span></dt><dd><p>The number of counterfactuals to generate for each instance.</p>
</dd>
</dl>
</section>
<section id="id22">
<h4>Returns:<a class="headerlink" href="#id22" title="Link to this heading"></a></h4>
<dl class="simple">
<dt>pd.DataFrame</dt><dd><p>A DataFrame containing the generated counterfactuals.</p>
</dd>
</dl>
</section>
<section id="raises">
<h4>Raises:<a class="headerlink" href="#raises" title="Link to this heading"></a></h4>
<dl class="simple">
<dt>ValueError</dt><dd><p>If the counterfactual generator has not been initialized (fit method not called).</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="humancompatible.explain.glance.local_cfs.dice_method.DiceMethod.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outcome_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">continuous_features</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">feat_to_vary</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">13</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/humancompatible/explain/glance/local_cfs/dice_method.html#DiceMethod.fit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#humancompatible.explain.glance.local_cfs.dice_method.DiceMethod.fit" title="Link to this definition"></a></dt>
<dd><p>Fits the DiceMethod to the provided dataset by creating a counterfactual generator.</p>
<section id="id23">
<h4>Parameters:<a class="headerlink" href="#id23" title="Link to this heading"></a></h4>
<dl class="simple">
<dt>model<span class="classifier">object</span></dt><dd><p>A machine learning model used for predictions.</p>
</dd>
<dt>data<span class="classifier">pd.DataFrame</span></dt><dd><p>The dataset containing features and the outcome variable.</p>
</dd>
<dt>outcome_name<span class="classifier">str</span></dt><dd><p>The name of the outcome variable in the dataset.</p>
</dd>
<dt>continuous_features<span class="classifier">List[str]</span></dt><dd><p>A list of names for continuous (numerical) features.</p>
</dd>
<dt>feat_to_vary<span class="classifier">List[str]</span></dt><dd><p>A list of feature names that can be varied to generate counterfactuals.</p>
</dd>
<dt>random_seed<span class="classifier">int, optional</span></dt><dd><p>Seed for random number generation to ensure reproducibility, by default 13.</p>
</dd>
</dl>
</section>
</dd></dl>

</section>
</dd></dl>

<dl class="py class" id="module-humancompatible.explain.glance.local_cfs.nearest_neighbor">
<dt class="sig sig-object py" id="humancompatible.explain.glance.local_cfs.nearest_neighbor.NearestNeighborMethod">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">humancompatible.explain.glance.local_cfs.nearest_neighbor.</span></span><span class="sig-name descname"><span class="pre">NearestNeighborMethod</span></span><a class="reference internal" href="_modules/humancompatible/explain/glance/local_cfs/nearest_neighbor.html#NearestNeighborMethod"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#humancompatible.explain.glance.local_cfs.nearest_neighbor.NearestNeighborMethod" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">LocalCounterfactualMethod</span></code></p>
<p>NearestNeighborMethod is a local counterfactual method that finds the nearest unaffected neighbors in the training dataset to explain instances by generating counterfactuals.</p>
<p>This method identifies instances in the training set where the model prediction remains unaffected,
and uses the nearest neighbors (based on feature similarity) to generate counterfactual explanations for new instances.</p>
<section id="id24">
<h3>Methods:<a class="headerlink" href="#id24" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>__init__():</dt><dd><p>Initializes the NearestNeighborMethod instance.</p>
</dd>
<dt>fit(model, data, outcome_name, continuous_features, feat_to_vary, random_seed=13):</dt><dd><p>Fits the method to the training data by identifying unaffected instances based on model predictions and preparing the feature encoding for nearest neighbor searches.</p>
</dd>
<dt>explain_instances(instances, num_counterfactuals):</dt><dd><p>Finds and returns the nearest unaffected neighbors for each instance, generating the specified number of counterfactual explanations.</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="humancompatible.explain.glance.local_cfs.nearest_neighbor.NearestNeighborMethod.explain_instances">
<span class="sig-name descname"><span class="pre">explain_instances</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">instances</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_counterfactuals</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">DataFrame</span></span></span><a class="reference internal" href="_modules/humancompatible/explain/glance/local_cfs/nearest_neighbor.html#NearestNeighborMethod.explain_instances"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#humancompatible.explain.glance.local_cfs.nearest_neighbor.NearestNeighborMethod.explain_instances" title="Link to this definition"></a></dt>
<dd><p>Generates counterfactual explanations for the provided instances by finding the nearest unaffected neighbors in the training data.</p>
<section id="id25">
<h4>Parameters:<a class="headerlink" href="#id25" title="Link to this heading"></a></h4>
<dl class="simple">
<dt>instances<span class="classifier">pd.DataFrame</span></dt><dd><p>DataFrame containing the instances for which counterfactual explanations are needed.</p>
</dd>
<dt>num_counterfactuals<span class="classifier">int</span></dt><dd><p>The number of counterfactuals to generate for each instance.</p>
</dd>
</dl>
</section>
<section id="id26">
<h4>Returns:<a class="headerlink" href="#id26" title="Link to this heading"></a></h4>
<dl class="simple">
<dt>pd.DataFrame</dt><dd><p>A DataFrame containing the nearest unaffected neighbors (counterfactuals) for each instance.</p>
</dd>
</dl>
</section>
<section id="notes">
<h4>Notes:<a class="headerlink" href="#notes" title="Link to this heading"></a></h4>
<ul class="simple">
<li><p>If the requested number of counterfactuals exceeds the number of available unaffected instances, a warning is raised, and all unaffected instances are used.</p></li>
<li><p>Nearest neighbors are determined using a one-hot encoded feature representation.</p></li>
</ul>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="humancompatible.explain.glance.local_cfs.nearest_neighbor.NearestNeighborMethod.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outcome_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">continuous_features</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">feat_to_vary</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">13</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/humancompatible/explain/glance/local_cfs/nearest_neighbor.html#NearestNeighborMethod.fit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#humancompatible.explain.glance.local_cfs.nearest_neighbor.NearestNeighborMethod.fit" title="Link to this definition"></a></dt>
<dd><p>Fits the NearestNeighborMethod by identifying unaffected instances in the training dataset and preparing feature encodings for counterfactual search.</p>
<section id="id27">
<h4>Parameters:<a class="headerlink" href="#id27" title="Link to this heading"></a></h4>
<dl class="simple">
<dt>model<span class="classifier">object</span></dt><dd><p>A machine learning model with a <cite>predict</cite> method that outputs binary predictions (0 or 1).</p>
</dd>
<dt>data<span class="classifier">pd.DataFrame</span></dt><dd><p>A dataset containing the features and outcome variable used for fitting the method.</p>
</dd>
<dt>outcome_name<span class="classifier">str</span></dt><dd><p>The name of the outcome column in the dataset.</p>
</dd>
<dt>continuous_features<span class="classifier">List[str]</span></dt><dd><p>A list of continuous (numerical) feature column names.</p>
</dd>
<dt>feat_to_vary<span class="classifier">List[str]</span></dt><dd><p>A list of features allowed to vary when generating counterfactuals.</p>
</dd>
<dt>random_seed<span class="classifier">int, optional</span></dt><dd><p>Seed for random number generation to ensure reproducibility, by default 13.</p>
</dd>
</dl>
</section>
</dd></dl>

</section>
</dd></dl>

<dl class="py class" id="module-humancompatible.explain.glance.local_cfs.random_sampling">
<dt class="sig sig-object py" id="humancompatible.explain.glance.local_cfs.random_sampling.RandomSampling">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">humancompatible.explain.glance.local_cfs.random_sampling.</span></span><span class="sig-name descname"><span class="pre">RandomSampling</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_most_important</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_categorical_most_frequent</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">numerical_features</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">categorical_features</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/humancompatible/explain/glance/local_cfs/random_sampling.html#RandomSampling"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#humancompatible.explain.glance.local_cfs.random_sampling.RandomSampling" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">LocalCounterfactualMethod</span></code></p>
<p>RandomSampling is a local counterfactual method that generates counterfactual instances
through random sampling based on the distribution of features in the unaffected training data.</p>
<p>This method identifies the most important features and the most frequent categories within the
unaffected training data to generate counterfactuals by sampling from these distributions.</p>
<section id="id28">
<h3>Methods:<a class="headerlink" href="#id28" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>__init__(model, n_most_important, n_categorical_most_frequent, numerical_features, categorical_features, random_state=None):</dt><dd><p>Initializes the RandomSampling instance with the specified parameters.</p>
</dd>
<dt>fit(X, y):</dt><dd><p>Fits the RandomSampling method to the provided training data by calculating feature importances and identifying unaffected instances.</p>
</dd>
<dt>_sample_instances(n_samples, fixed_feature_values, random_state=None):</dt><dd><p>Samples instances based on the specified feature distributions, fixing certain feature values while sampling others.</p>
</dd>
<dt>explain(instance, num_counterfactuals, n_samples=1000, random_state=None):</dt><dd><p>Generates counterfactual explanations for a given instance by sampling and modifying feature values.</p>
</dd>
<dt>explain_instances(instances, num_counterfactuals, n_samples=1000, random_state=None):</dt><dd><p>Generates counterfactuals for multiple instances by calling the explain method for each instance.</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="humancompatible.explain.glance.local_cfs.random_sampling.RandomSampling.explain">
<span class="sig-name descname"><span class="pre">explain</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">instance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_counterfactuals</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_samples</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/humancompatible/explain/glance/local_cfs/random_sampling.html#RandomSampling.explain"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#humancompatible.explain.glance.local_cfs.random_sampling.RandomSampling.explain" title="Link to this definition"></a></dt>
<dd><p>Generates counterfactual explanations for a given instance by sampling and modifying feature values.</p>
<section id="id29">
<h4>Parameters:<a class="headerlink" href="#id29" title="Link to this heading"></a></h4>
<dl class="simple">
<dt>instance<span class="classifier">pd.DataFrame</span></dt><dd><p>A single row DataFrame representing the instance for which counterfactuals are generated.</p>
</dd>
<dt>num_counterfactuals<span class="classifier">int</span></dt><dd><p>The number of counterfactuals to generate.</p>
</dd>
<dt>n_samples<span class="classifier">int, optional</span></dt><dd><p>The number of samples to draw for generating counterfactuals, by default 1000.</p>
</dd>
<dt>random_state<span class="classifier">int, optional</span></dt><dd><p>Seed for random number generation, by default None.</p>
</dd>
</dl>
</section>
<section id="id30">
<h4>Returns:<a class="headerlink" href="#id30" title="Link to this heading"></a></h4>
<dl class="simple">
<dt>pd.DataFrame</dt><dd><p>A DataFrame containing the generated counterfactuals for the provided instance.</p>
</dd>
</dl>
</section>
<section id="id31">
<h4>Raises:<a class="headerlink" href="#id31" title="Link to this heading"></a></h4>
<dl class="simple">
<dt>ValueError</dt><dd><p>If the input instance is not a single-row DataFrame or if its columns do not match the training dataset’s columns.</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="humancompatible.explain.glance.local_cfs.random_sampling.RandomSampling.explain_instances">
<span class="sig-name descname"><span class="pre">explain_instances</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">instances</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_counterfactuals</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_samples</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">DataFrame</span></span></span><a class="reference internal" href="_modules/humancompatible/explain/glance/local_cfs/random_sampling.html#RandomSampling.explain_instances"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#humancompatible.explain.glance.local_cfs.random_sampling.RandomSampling.explain_instances" title="Link to this definition"></a></dt>
<dd><p>Generates counterfactuals for multiple instances by calling the explain method for each instance.</p>
<section id="id32">
<h4>Parameters:<a class="headerlink" href="#id32" title="Link to this heading"></a></h4>
<dl class="simple">
<dt>instances<span class="classifier">pd.DataFrame</span></dt><dd><p>DataFrame containing instances for which counterfactual explanations are needed.</p>
</dd>
<dt>num_counterfactuals<span class="classifier">int</span></dt><dd><p>The number of counterfactuals to generate for each instance.</p>
</dd>
<dt>n_samples<span class="classifier">int, optional</span></dt><dd><p>The number of samples to draw for generating counterfactuals, by default 1000.</p>
</dd>
<dt>random_state<span class="classifier">int, optional</span></dt><dd><p>Seed for random number generation, by default None.</p>
</dd>
</dl>
</section>
<section id="id33">
<h4>Returns:<a class="headerlink" href="#id33" title="Link to this heading"></a></h4>
<dl class="simple">
<dt>pd.DataFrame</dt><dd><p>A DataFrame containing the generated counterfactuals for all provided instances.</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="humancompatible.explain.glance.local_cfs.random_sampling.RandomSampling.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Series</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/humancompatible/explain/glance/local_cfs/random_sampling.html#RandomSampling.fit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#humancompatible.explain.glance.local_cfs.random_sampling.RandomSampling.fit" title="Link to this definition"></a></dt>
<dd><p>Fits the RandomSampling method to the provided training data by calculating feature importances and identifying unaffected instances.</p>
<section id="id34">
<h4>Parameters:<a class="headerlink" href="#id34" title="Link to this heading"></a></h4>
<dl class="simple">
<dt>X<span class="classifier">pd.DataFrame</span></dt><dd><p>The training dataset containing feature columns.</p>
</dd>
<dt>y<span class="classifier">pd.Series</span></dt><dd><p>The target variable corresponding to the training dataset.</p>
</dd>
</dl>
</section>
<section id="id35">
<h4>Returns:<a class="headerlink" href="#id35" title="Link to this heading"></a></h4>
<dl class="simple">
<dt>self<span class="classifier">RandomSampling</span></dt><dd><p>Returns the fitted instance of RandomSampling.</p>
</dd>
</dl>
</section>
</dd></dl>

</section>
</dd></dl>

</section>
<section id="module-humancompatible.explain.glance.utils.action">
<span id="utility-functions"></span><h2><a class="toc-backref" href="#id45" role="doc-backlink">Utility Functions</a><a class="headerlink" href="#module-humancompatible.explain.glance.utils.action" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="humancompatible.explain.glance.utils.action.actions_mean_pandas">
<span class="sig-prename descclassname"><span class="pre">humancompatible.explain.glance.utils.action.</span></span><span class="sig-name descname"><span class="pre">actions_mean_pandas</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">actions</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">numerical_features</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">categorical_features</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">categorical_no_action_token</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Series</span></span></span><a class="reference internal" href="_modules/humancompatible/explain/glance/utils/action.html#actions_mean_pandas"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#humancompatible.explain.glance.utils.action.actions_mean_pandas" title="Link to this definition"></a></dt>
<dd><p>Computes the mean action for numerical features and the most frequent action for categorical features from a given actions DataFrame.</p>
<p>For numerical features, the function calculates the mean of the actions across all instances.
For categorical features, it determines the most frequent value in the <cite>actions</cite> DataFrame, unless all values are equal to the <cite>categorical_no_action_token</cite>,
in which case the token is returned.</p>
<section id="id36">
<h3>Parameters:<a class="headerlink" href="#id36" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>actions<span class="classifier">pd.DataFrame</span></dt><dd><p>A DataFrame where each row represents an instance, and each column represents an action for a feature (either numerical or categorical).</p>
</dd>
<dt>numerical_features<span class="classifier">List[str]</span></dt><dd><p>List of columns in <cite>actions</cite> that are numerical features.</p>
</dd>
<dt>categorical_features<span class="classifier">List[str]</span></dt><dd><p>List of columns in <cite>actions</cite> that are categorical features.</p>
</dd>
<dt>categorical_no_action_token<span class="classifier">Any</span></dt><dd><p>A token or value that indicates no action is needed for categorical features.</p>
</dd>
</dl>
</section>
<section id="id37">
<h3>Returns:<a class="headerlink" href="#id37" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>pd.Series</dt><dd><p>A Series where:
- For numerical features, the values are the mean of the actions for each numerical column.
- For categorical features, the values are the most frequent action in each categorical column, or the <cite>categorical_no_action_token</cite> if no action was needed.</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="humancompatible.explain.glance.utils.action.apply_action_numpy">
<span class="sig-prename descclassname"><span class="pre">humancompatible.explain.glance.utils.action.</span></span><span class="sig-name descname"><span class="pre">apply_action_numpy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">number</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">action</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">number</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">numerical_columns</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">categorical_columns</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">categorical_no_action_token</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">number</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">number</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/humancompatible/explain/glance/utils/action.html#apply_action_numpy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#humancompatible.explain.glance.utils.action.apply_action_numpy" title="Link to this definition"></a></dt>
<dd><p>Apply <cite>action</cite> to all rows of <cite>X</cite>. For numerical columns, add the
respective component from <cite>action</cite>. For categorical columns, set the
component of all rows to the value of <cite>action</cite>, unless it is equal to
the <cite>categorical_no_action_token</cite>, in which case do nothing for this
column.</p>
<p>Note: input array should have a numeric dtype. Thus, categorical columns
should be encoded by numbers (e.g. Ordinal Encoding).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>npt.NDArray</em><em>[</em><em>np.number</em><em>]</em>) – matrix of observations</p></li>
<li><p><strong>action</strong> (<em>npt.NDArray</em><em>[</em><em>np.number</em><em>]</em>) – for each column / feature, the action to be applied</p></li>
<li><p><strong>numerical_columns</strong> (<em>List</em><em>[</em><em>int</em><em>]</em>) – numerical column indices</p></li>
<li><p><strong>categorical_columns</strong> (<em>List</em><em>[</em><em>int</em><em>]</em>) – categorical column indices</p></li>
<li><p><strong>categorical_no_action_token</strong> (<em>np.number</em>) – special value signifying no-action (i.e. equivalent to 0 for numerical columns)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>new observations resulting from the action application.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>npt.NDArray[np.number]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="humancompatible.explain.glance.utils.action.apply_action_pandas">
<span class="sig-prename descclassname"><span class="pre">humancompatible.explain.glance.utils.action.</span></span><span class="sig-name descname"><span class="pre">apply_action_pandas</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">action</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Series</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">numerical_columns</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">categorical_columns</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">categorical_no_action_token</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">numerical_no_action_token</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">DataFrame</span></span></span><a class="reference internal" href="_modules/humancompatible/explain/glance/utils/action.html#apply_action_pandas"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#humancompatible.explain.glance.utils.action.apply_action_pandas" title="Link to this definition"></a></dt>
<dd><p>Apply <cite>action</cite> to all rows of <cite>X</cite>. For numerical columns, add the
respective component from <cite>action</cite>. For categorical columns, set the
component of all rows to the value of <cite>action</cite>, unless it is equal to
the <cite>categorical_no_action_token</cite>, in which case do nothing for this
column.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>pd.DataFrame</em>) – matrix of observations</p></li>
<li><p><strong>action</strong> (<em>pd.Series</em>) – for each column / feature, the action to be applied</p></li>
<li><p><strong>numerical_columns</strong> (<em>List</em><em>[</em><em>str</em><em>]</em>) – numerical column names</p></li>
<li><p><strong>categorical_columns</strong> (<em>List</em><em>[</em><em>str</em><em>]</em>) – categorical column names</p></li>
<li><p><strong>categorical_no_action_token</strong> (<em>Any</em>) – special value signifying no-action (i.e. equivalent to 0 for numerical columns)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>new observations resulting from the action application.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="humancompatible.explain.glance.utils.action.apply_actions_pandas_rows">
<span class="sig-prename descclassname"><span class="pre">humancompatible.explain.glance.utils.action.</span></span><span class="sig-name descname"><span class="pre">apply_actions_pandas_rows</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">actions</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">numerical_columns</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">categorical_columns</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">categorical_no_action_token</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">object</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">DataFrame</span></span></span><a class="reference internal" href="_modules/humancompatible/explain/glance/utils/action.html#apply_actions_pandas_rows"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#humancompatible.explain.glance.utils.action.apply_actions_pandas_rows" title="Link to this definition"></a></dt>
<dd><p>Applies a set of actions to transform the original dataset <cite>X</cite> based on the actions specified in the <cite>actions</cite> DataFrame.</p>
<p>For numerical columns, the function adds the values from the <cite>actions</cite> DataFrame to the corresponding columns in <cite>X</cite>.
For categorical columns, if the action for a column is not equal to the <cite>categorical_no_action_token</cite>, the value from the <cite>actions</cite> DataFrame is used to update <cite>X</cite>.
Otherwise, the original value from <cite>X</cite> is retained.</p>
<section id="id38">
<h3>Parameters:<a class="headerlink" href="#id38" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>X<span class="classifier">pd.DataFrame</span></dt><dd><p>The original dataset, where each row represents an instance, and each column is a feature.</p>
</dd>
<dt>actions<span class="classifier">pd.DataFrame</span></dt><dd><p>A DataFrame of the same shape as <cite>X</cite>, containing the actions to apply to each feature.
- For numerical columns: contains the values to add to the corresponding features in <cite>X</cite>.
- For categorical columns: contains either the new value to apply or the <cite>categorical_no_action_token</cite>.</p>
</dd>
<dt>numerical_columns<span class="classifier">List[str]</span></dt><dd><p>List of columns in <cite>X</cite> and <cite>actions</cite> that are numerical.</p>
</dd>
<dt>categorical_columns<span class="classifier">List[str]</span></dt><dd><p>List of columns in <cite>X</cite> and <cite>actions</cite> that are categorical.</p>
</dd>
<dt>categorical_no_action_token<span class="classifier">object</span></dt><dd><p>A token or value indicating that no action should be taken for a categorical feature.</p>
</dd>
</dl>
</section>
<section id="id39">
<h3>Returns:<a class="headerlink" href="#id39" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>pd.DataFrame</dt><dd><p>A DataFrame of the same shape as <cite>X</cite> where the actions have been applied:
- For numerical columns: each value is updated by adding the corresponding action from <cite>actions</cite>.
- For categorical columns: updated values from <cite>actions</cite> are used where applicable; otherwise, the original values from <cite>X</cite> are retained.</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="humancompatible.explain.glance.utils.action.extract_actions_pandas">
<span class="sig-prename descclassname"><span class="pre">humancompatible.explain.glance.utils.action.</span></span><span class="sig-name descname"><span class="pre">extract_actions_pandas</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cfs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">categorical_features</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">numerical_features</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">categorical_no_action_token</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/humancompatible/explain/glance/utils/action.html#extract_actions_pandas"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#humancompatible.explain.glance.utils.action.extract_actions_pandas" title="Link to this definition"></a></dt>
<dd><p>Extracts the actions needed to convert the original dataset <cite>X</cite> into the counterfactual dataset <cite>cfs</cite>.</p>
<p>For categorical features, the function identifies changes between <cite>X</cite> and <cite>cfs</cite>.
If no change is observed in a categorical feature, a specified <cite>categorical_no_action_token</cite> is used to denote that no action is needed.
For numerical features, the function computes the difference between the counterfactual and the original values.</p>
<section id="id40">
<h3>Parameters:<a class="headerlink" href="#id40" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>X<span class="classifier">pd.DataFrame</span></dt><dd><p>The original dataset, where each row represents an instance, and each column is a feature.</p>
</dd>
<dt>cfs<span class="classifier">pd.DataFrame</span></dt><dd><p>The counterfactual dataset, which has the same structure as <cite>X</cite>. It represents the desired state after some action is applied.</p>
</dd>
<dt>categorical_features<span class="classifier">List[str]</span></dt><dd><p>List of columns in <cite>X</cite> and <cite>cfs</cite> that are categorical.</p>
</dd>
<dt>numerical_features<span class="classifier">List[str]</span></dt><dd><p>List of columns in <cite>X</cite> and <cite>cfs</cite> that are numerical.</p>
</dd>
<dt>categorical_no_action_token<span class="classifier">Any</span></dt><dd><p>A token or value to insert into categorical features where no change is needed (i.e., the feature value in <cite>X</cite> is the same as in <cite>cfs</cite>).</p>
</dd>
</dl>
</section>
<section id="id41">
<h3>Returns:<a class="headerlink" href="#id41" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>pd.DataFrame</dt><dd><p>A DataFrame of the same shape as <cite>X</cite> and <cite>cfs</cite> where each value indicates the action required to transform <cite>X</cite> into <cite>cfs</cite>:
- For categorical features: the value in <cite>cfs</cite> if it differs from <cite>X</cite>, otherwise <cite>categorical_no_action_token</cite>.
- For numerical features: the difference between <cite>cfs</cite> and <cite>X</cite>.</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py function" id="module-humancompatible.explain.glance.utils.centroid">
<dt class="sig sig-object py" id="humancompatible.explain.glance.utils.centroid.centroid_numpy">
<span class="sig-prename descclassname"><span class="pre">humancompatible.explain.glance.utils.centroid.</span></span><span class="sig-name descname"><span class="pre">centroid_numpy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">number</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">numerical_columns</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">categorical_columns</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">number</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/humancompatible/explain/glance/utils/centroid.html#centroid_numpy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#humancompatible.explain.glance.utils.centroid.centroid_numpy" title="Link to this definition"></a></dt>
<dd><p>Calculates the centroid of the rows of a 2d numy array. Specifically,
for the <cite>numerical_columns</cite> columns, the centroid has value the mean of all
rows, while for the <cite>categorical_columns</cite> columns, the centroid has value
the mode of all rows.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>npt.NDArray</em><em>[</em><em>np.number</em><em>]</em>) – matrix of observations</p></li>
<li><p><strong>numerical_columns</strong> (<em>List</em><em>[</em><em>int</em><em>]</em>) – numerical column indices</p></li>
<li><p><strong>categorical_columns</strong> (<em>List</em><em>[</em><em>int</em><em>]</em>) – categorical column indices</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>2d numpy array whose single row is the centroid</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>npt.NDArray[np.number]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="humancompatible.explain.glance.utils.centroid.centroid_pandas">
<span class="sig-prename descclassname"><span class="pre">humancompatible.explain.glance.utils.centroid.</span></span><span class="sig-name descname"><span class="pre">centroid_pandas</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">numerical_columns</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">categorical_columns</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">DataFrame</span></span></span><a class="reference internal" href="_modules/humancompatible/explain/glance/utils/centroid.html#centroid_pandas"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#humancompatible.explain.glance.utils.centroid.centroid_pandas" title="Link to this definition"></a></dt>
<dd><p>Calculates the centroid of the rows of a pandas DataFrame. Specifically,
for the <cite>numerical_columns</cite> columns, the centroid has value the mean of all
rows, while for the <cite>categorical_columns</cite> columns, the centroid has value
the mode of all rows.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>pd.DataFrame</em>) – matrix of observations</p></li>
<li><p><strong>numerical_columns</strong> (<em>List</em><em>[</em><em>str</em><em>]</em>) – numerical column names</p></li>
<li><p><strong>categorical_columns</strong> (<em>List</em><em>[</em><em>str</em><em>]</em>) – categorical column names</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>DataFrame whose single row is the centroid</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
</dl>
</dd></dl>

<span class="target" id="module-humancompatible.explain.glance.utils.metadata_requests"></span></section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="facts.html" class="btn btn-neutral float-left" title="FACTS: Fairness Aware Counterfactual for Subgrouos package" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="fcx.html" class="btn btn-neutral float-right" title="FCX: Finding Feasible Counterfactual Explanation" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, AutoFair Project.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>